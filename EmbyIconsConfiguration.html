﻿<div is="emby-scroller" class="view flex flex-direction-column scrollFrameY flex-grow" data-horizontal="false" data-forcescrollbar="true" data-centerfocus="true" data-bindheader="true" data-controller="__plugin/EmbyIconsConfigurationjs" data-title="EmbyIcons">

    <div class="scrollSlider flex-grow flex-direction-column padded-left padded-left-page padded-right padded-top-page padded-bottom-page">
        <div class="readOnlyContent auto-center">

            <div data-role="controlgroup" data-type="horizontal" class="localnav">
                <a is="emby-linkbutton" class="nav-settings ui-btn-active" href="#" data-role="button">Settings</a>
                <a is="emby-linkbutton" class="nav-readme" href="#" data-role="button">Readme</a>
            </div>

            <div id="settingsPage" style="margin-top: 2em;">
                <form class="embyIconsForm">
                    <div class="flex align-items-center" style="margin: 2em 0 .5em;">
                        <h2 style="margin: 0;">General Settings</h2>
                    </div>
                    <div class="inputContainer">
                        <div style="display: flex; align-items: flex-end;">
                            <div style="flex-grow: 1;">
                                <input is="emby-input" type="text" id="txtIconsFolder" label="Icons Folder:" autocomplete="off" />
                            </div>
                            <button type="button" is="emby-button" class="raised" id="btnSelectIconsFolder" title="Browse for folder" style="margin-left: 1em;">
                                <span>...</span>
                            </button>
                        </div>
                        <div class="fieldDescription">The full path to the folder where your custom icons are stored.</div>
                    </div>

                    <div class="flex align-items-center" style="margin: 2em 0 .5em;">
                        <h3 style="margin: 0;">Cache Management</h3>
                    </div>
                    <div class="fieldDescription" style="margin-bottom: 1em;">
                        If you have added, removed, or changed any icon files, clear the cache to apply the changes.
                        Your posters will be updated with the new icons as you browse your libraries.
                    </div>
                    <div>
                        <button is="emby-button" type="button" class="raised button-cancel" id="btnClearCache">
                            <span>Clear Icon Cache</span>
                        </button>
                    </div>

                    <div class="inputContainer" style="margin-top: 2.5em;">
                        <h3 style="margin-bottom: 0.5em;">Apply to these libraries</h3>
                        <div id="librarySelectionContainer" class="paper-card" style="padding: 1em 1.5em; display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 0.5em 1.5em;">
                        </div>
                        <div class="fieldDescription" style="margin-top: 0.5em;">Leave all unchecked to apply to all libraries.</div>
                        <input type="hidden" id="txtSelectedLibraries" />
                    </div>

                    <div class="flex align-items-center" style="margin: 3em 0 .5em;">
                        <h2 style="margin: 0;">Overlay Toggles</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1em 2em;">
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowAudioIcons" /><span>Show Audio Language Icons</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowSubtitleIcons" /><span>Show Subtitle Language Icons</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowAudioChannelIcons" /><span>Show Audio Channel Icons (e.g., 7.1)</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowAudioCodecIcons" /><span>Show Audio Codec Icons (e.g., DTS)</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowVideoFormatIcons" /><span>Show Video Format Icons (e.g., HDR)</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowVideoCodecIcons" /><span>Show Video Codec Icons (e.g., H265)</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowTagIcons" /><span>Show Custom Tag Icons</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowResolutionIcons" /><span>Show Resolution Icons (e.g., 4K)</span></label></div>
                        <div class="checkboxContainer"><label><input is="emby-checkbox" type="checkbox" id="chkShowCommunityScoreIcon" /><span>Show Community Rating Icon</span></label></div>
                    </div>

                    <div class="flex align-items-center" style="margin: 3em 0 .5em;">
                        <h2 style="margin: 0;">TV Show Settings</h2>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label><input is="emby-checkbox" type="checkbox" id="chkShowOverlaysForEpisodes" /><span>Show overlays on episode images</span></label>
                        <div class="fieldDescription checkboxFieldDescription">When disabled, overlays will only appear on movies, series, and seasons.</div>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label><input is="emby-checkbox" type="checkbox" id="chkShowSeriesIconsIfAllEpisodesHaveLanguage" /><span>Show icons on series/seasons</span></label>
                        <div class="fieldDescription checkboxFieldDescription">Icons will only appear on a series/season poster if all child episodes share the same property.</div>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label><input is="emby-checkbox" type="checkbox" id="chkUseSeriesLiteMode" /><span>Use Lite Mode for series scans</span></label>
                        <div class="fieldDescription checkboxFieldDescription">Faster, but less accurate. Only checks the first episode to determine icons for the entire series.</div>
                    </div>

                    <div class="flex align-items-center" style="margin: 3em 0 .5em;">
                        <h2 style="margin: 0;">Alignment & Layout</h2>
                    </div>
                    <div class="paper-card" style="padding: 1.5em;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2em 2.5em;">
                            <div>
                                <select is="emby-select" id="selAudioIconAlignment" label="Audio Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkAudioOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selSubtitleIconAlignment" label="Subtitle Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkSubtitleOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selChannelIconAlignment" label="Channel Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkChannelOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selAudioCodecIconAlignment" label="Audio Codec Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkAudioCodecOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selVideoFormatIconAlignment" label="Video Format Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkVideoFormatOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selVideoCodecIconAlignment" label="Video Codec Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkVideoCodecOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selTagIconAlignment" label="Tag Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkTagOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selResolutionIconAlignment" label="Resolution Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkResolutionOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selCommunityScoreIconAlignment" label="Rating Icon Alignment"><option value="TopLeft">Top Left</option><option value="TopRight">Top Right</option><option value="BottomLeft">Bottom Left</option><option value="BottomRight">Bottom Right</option></select>
                                <div class="checkboxContainer" style="margin-top: 1.5em;"><label><input is="emby-checkbox" type="checkbox" id="chkCommunityScoreOverlayHorizontal" /><span>Layout Horizontally</span></label></div>
                            </div>
                            <div>
                                <select is="emby-select" id="selCommunityScoreBackgroundShape" label="Rating Background Shape">
                                    <option value="None">None</option>
                                    <option value="Circle">Circle</option>
                                    <option value="Square">Square</option>
                                </select>
                                <div style="margin-top: 1.5em;">
                                    <label class="inputLabel" for="txtCommunityScoreBackgroundColor">Background Color</label>
                                    <input type="color" id="txtCommunityScoreBackgroundColor" style="width: 100%; height: 2.5em; padding: 0.2em; background: transparent; border: 1px solid rgb(85, 85, 85); border-radius: 4px; box-sizing: border-box;">
                                </div>
                                <div style="margin-top: 1.5em;">
                                    <label class="inputLabel" for="rngCommunityScoreBackgroundOpacity">Background Opacity: <span id="valCommunityScoreBackgroundOpacity"></span></label>
                                    <input type="range" min="0" max="100" step="1" id="rngCommunityScoreBackgroundOpacity" class="slider" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex align-items-center" style="margin: 3em 0 .5em;">
                        <h2 style="margin: 0;">Advanced Settings</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1em 2em;">
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="txtIconSize" label="Icon Size (% of poster height):" min="1" max="100" />
                        </div>
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="txtJpegQuality" label="Image Quality (10-100):" min="10" max="100" />
                        </div>
                        <div class="checkboxContainer" style="grid-column: 1 / -1;">
                            <label>
                                <input is="emby-checkbox" type="checkbox" id="chkEnableImageSmoothing" />
                                <span>Enable image smoothing (improves icon quality on scaled images)</span>
                            </label>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 2em;">
                        <img class="previewImage" alt="Loading Preview..." style="max-height: 24em; display: block; background-color: #101010; margin: auto;" />
                    </div>

                    <div style="margin-top: 2em;">
                        <button is="emby-button" type="submit" class="raised button-submit block">
                            <span>Save</span>
                        </button>
                    </div>
                </form>
            </div>

            <div id="readmePage" class="hide" style="margin-top: 2em;">
                <div style="max-width: 800px; margin: auto;">
                    <h1 style="margin-bottom: 1em;">EmbyIcons Plugin Guide</h1>

                    <h3>Introduction</h3>
                    <p>This plugin overlays icons for language, audio channels, video format, resolution, and community ratings onto your media posters. To work correctly, you must provide your own icon images in a designated folder and name them according to the conventions below.</p>
                    <p>Supported image formats for icons are <code>.png</code>, <code>.jpg</code>, <code>.webp</code>, etc.</p>

                    <h3 style="margin-top: 2em;">Icon Naming Conventions</h3>

                    <h4>Audio Language Icons</h4>
                    <p>Name audio icons using the 3-letter ISO 639-2 language code. The plugin will automatically try to map 2-letter codes to 3-letter codes.</p>
                    <ul>
                        <li>Example: <code>eng.png</code> (for English), <code>fre.png</code> (for French), <code>jpn.png</code> (for Japanese).</li>
                    </ul>

                    <h4>Subtitle Language Icons</h4>
                    <p>Name subtitle icons by prefixing the 3-letter language code with <code>srt.</code></p>
                    <ul>
                        <li>Example: <code>srt.eng.png</code>, <code>srt.fre.png</code></li>
                    </ul>

                    <h4>Custom Tag Icons</h4>
                    <p>You can display icons for specific media tags. The plugin will automatically look for an icon that matches the name of the tag on the media item. The matching is case-insensitive, so a tag of '3D' will match an icon named `3d.png`.</p>
                    <ul>
                        <li>Example: For the tag '3D', create an icon named <code>3D.png</code>. For `VR`, create `VR.png`.</li>
                        <li>For the live preview, an icon named `tag.png` will be used if it exists in the icons folder.</li>
                    </ul>

                    <h4>Audio Channel Icons</h4>
                    <p>These icons represent the number of audio channels.</p>
                    <ul>
                        <li>Mono: <code>mono.png</code></li>
                        <li>Stereo (2.0): <code>stereo.png</code></li>
                        <li>5.1 Surround: <code>5.1.png</code></li>
                        <li>7.1 Surround: <code>7.1.png</code></li>
                    </ul>

                    <h4>Audio Codec Icons</h4>
                    <p>These icons represent the audio codec format.</p>
                    <ul>
                        <li>AAC: <code>aac.png</code></li>
                        <li>PCM: <code>pcm.png</code></li>
                        <li>FLAC: <code>flac.png</code></li>
                        <li>MP3: <code>mp3.png</code></li>
                        <li>AC3: <code>ac3.png</code></li>
                        <li>EAC3: <code>eac3.png</code></li>
                        <li>DTS: <code>dts.png</code></li>
                        <li>TrueHD: <code>truehd.png</code></li>
                    </ul>

                    <h4>Video Format Icons</h4>
                    <p>For High Dynamic Range (HDR) formats.</p>
                    <ul>
                        <li>Generic HDR: <code>hdr.png</code></li>
                        <li>Dolby Vision: <code>dv.png</code></li>
                        <li>HDR10+: <code>hdr10plus.png</code></li>
                    </ul>
                    <p>For best results, including "HDR10+" in the video's filename provides a reliable detection method. The plugin will also attempt to detect this format from the video stream's metadata where available.</p>

                    <h4>Video Codec Icons</h4>
                    <p>These icons represent the video codec format.</p>
                    <ul>
                        <li>AV1: <code>av1.png</code></li>
                        <li>AVC / H.264: <code>h264.png</code></li>
                        <li>HEVC / H.265: <code>h265.png</code></li>
                        <li>VVC / H.266: <code>h266.png</code></li>
                        <li>MPEG-4: <code>mp4.png</code></li>
                        <li>VC-1: <code>vc1.png</code></li>
                        <li>VP9: <code>vp9.png</code></li>
                    </ul>

                    <h4>Resolution Icons</h4>
                    <p>Icons for video resolution.</p>
                    <ul>
                        <li>4K: <code>4k.png</code></li>
                        <li>1080p: <code>1080p.png</code></li>
                        <li>720p: <code>720p.png</code></li>
                        <li>576p: <code>576p.png</code> </li>
                        <li>480p: <code>480p.png</code> </li>
                    </ul>

                    <h4>Community Rating Icon</h4>
                    <p>This icon is displayed next to the IMDb rating. If no icon is provided it will just show the rating</p>
                    <ul>
                        <li>Example: <code>imdb.png</code></li>
                    </ul>

                    <div style="margin-top: 3em; padding: 1em; background-color: rgba(255, 235, 59, 0.1); border-left: 4px solid #ffeb3b; border-radius: 4px;">
                        <div style="display: flex; align-items: center; gap: 1em;">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" fill="#ffeb3b" style="flex-shrink: 0;">
                                <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"></path>
                            </svg>
                            <div>
                                <p style="margin: 0 0 0.5em 0; font-weight: 500;">Thank you to all supporters and people that helped testing this, specially Neminem from the Emby forum.</p>
                                <p style="margin: 0;">If you like this project and would like to support it then you can <a href="https://buymeacoffee.com/yockser" target="_blank" rel="noopener noreferrer">donate me a coffee</a>, remember to write your name and i will add it here!</p>
                                <p style="margin: 0 0 0.5em 0; font-weight: 500;">Thank you for the donations to:</p>
                                <p style="margin: 0 0 0.5em 0; font-weight: 500;">Alexander Hürter.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>